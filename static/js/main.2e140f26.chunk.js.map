{"version":3,"sources":["contexts.js","firebase.js","components/Form/Form.jsx","components/Form/Field.jsx","components/Form/AuthForm.jsx","components/Header.jsx","api/bookAPI.js","contexts/BookContext.js","utils/useFetchOnIntersection.js","components/Form/Button.jsx","components/Book.jsx","components/Books.jsx","components/Manage.jsx","App.js","index.js"],"names":["AuthContext","React","createContext","firebase","initializeApp","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","auth","firestore","Form","children","onSubmit","props","e","preventDefault","target","elements","Field","name","value","useState","state","setState","onChange","AuthForm","closeForm","switched","setSwitched","signInError","setSignInError","signUpError","setSignUpError","fetching","setFetching","formRef","useRef","authenticate","api","data","errorFunc","errorText","a","then","setTimeout","signUp","createUserWithEmailAndPassword","email","password","signIn","signInWithEmailAndPassword","useEffect","handleClick","current","document","addEventListener","removeEventListener","className","ref","onClick","disabled","type","required","placeholder","body","Header","user","useContext","formOpen","setFormOpen","menu","closePopUpMenu","classList","remove","toggle","to","process","signOut","style","overflow","collection","bookAPI","id","doc","delete","authors","year","isbn","add","set","BookContext","useBookContext","SET_BOOKS","TOGGLE_FETCHING","SET_NO_BOOKS_LEFT","REMOVE_BOOK","ADD_BOOK","EDIT_BOOK","initialState","books","noBooksLeft","reducer","action","filter","b","book","map","newBookData","BookProvider","useReducer","dispatch","lastDocRef","toggleFetchingDispatcher","isFetching","setBooksDispatcher","addBookDispatcher","removeBookDispatcher","editBookDispatcher","fetchBooks","useCallback","limit","orderBy","startAfter","get","size","result","docs","length","fetchingBooks","removeBook","addBook","editBook","Provider","useFetchOnIntersection","fetchFunc","observableNodeRef","observerRef","IntersectionObserver","isIntersecting","observableNode","observe","unobserve","styles","padding","backgroundColor","border","color","borderRadius","cursor","outline","Button","Book","provideData","authorFieldCount","setAuthorFieldCount","addMode","setAddMode","editMode","setEditMode","authorFields","i","push","Fragment","prev","join","Books","onScrollFetch","btnTitle","height","display","Manage","getFormInfo","dataCollection","onEditBook","App","setUser","loading","setLoading","onAuthStateChanged","basename","exact","path","component","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.2e140f26.chunk.js","sourcesContent":["import React from \"react\";\n\nexport const AuthContext = React.createContext();","import firebase from \"firebase/app\";\nimport \"firebase/firestore\";\nimport \"firebase/auth\";\n\nconst firebaseConfig = {\n  apiKey: \"AIzaSyCzhjL5kmDoyu9baGGhnH-dGOgAiNzVxpM\",\n  authDomain: \"react-book-catalog-b3457.firebaseapp.com\",\n  projectId: \"react-book-catalog-b3457\",\n  storageBucket: \"react-book-catalog-b3457.appspot.com\",\n  messagingSenderId: \"552036910915\",\n  appId: \"1:552036910915:web:0e3e78422112d9883b11f6\"\n};\n\nfirebase.initializeApp(firebaseConfig);\n\nexport const auth = firebase.auth();\n\nexport const firestore = firebase.firestore();\n\nexport default firebase;","const Form = ({ children, onSubmit, ...props }) => {\n  const onFormSubmit = (e) => {\n    e.preventDefault();\n    onSubmit(e.target.elements);\n  }\n\n  return (\n    <form onSubmit={onFormSubmit} { ...props }>\n      { children }\n    </form>\n  )\n}\n\nexport default Form;","import { useState } from \"react\"\n\nconst Field = ({ name, value, ...props }) => {\n  const [state, setState] = useState(value || \"\");\n\n  return <input name={name} value={state} onChange={(e) => setState(e.target.value)} { ...props } />\n}\n\nexport default Field;","import \"./../../styles/AuthForm.scss\";\nimport { useEffect, useRef, useState } from \"react\";\nimport Form from \"./Form\";\nimport Field from \"./Field\";\nimport { auth } from \"../../firebase\";\n\nconst AuthForm = ({ closeForm }) => {\n  const [switched, setSwitched] = useState(false);\n  const [signInError, setSignInError] = useState();\n  const [signUpError, setSignUpError] = useState();\n  const [fetching, setFetching] = useState(false);\n  const formRef = useRef();\n\n  const authenticate = async (api, data, errorFunc, errorText) => {\n    try {\n      setFetching(true);\n      errorFunc(null)\n      await api(data)\n        .then(() => {\n          setFetching(false);\n          closeForm();\n        })\n    } catch (error) {\n      errorFunc(errorText);\n      setFetching(false);\n      setTimeout(errorFunc, 4000, null);\n    }\n  }\n\n  const signUp = async (data) => {\n    return await auth.createUserWithEmailAndPassword(data.email.value, data.password.value);\n  }\n\n  const signIn = async (data) => {\n    return await auth.signInWithEmailAndPassword(data.email.value, data.password.value);\n  }\n\n  const onSignInFormSubmit = (data) => {\n    authenticate(signIn, data, setSignInError, \"Ошибка входа\");\n  }\n\n  const onSignUpFormSubmit = (data) => {\n    authenticate(signUp, data, setSignUpError, \"Ошибка регистрации\");\n  }\n\n  useEffect(() => {\n    const handleClick = (e) => {\n      if (e.target === formRef.current) closeForm();\n    }\n\n    document.addEventListener(\"click\", handleClick);\n    return () => document.removeEventListener(\"click\", handleClick);\n  }, [closeForm])\n\n  return (\n    <div className=\"authForm\" ref={formRef}>\n      <div className=\"authForm__wrapper\">\n        <div className=\"authForm__close-ico-wrapper\">\n          <i className=\"authForm__close-ico fas fa-times\" onClick={() => !fetching && closeForm()}></i>\n        </div>\n        <header className=\"authForm__header\">\n          <div className=\"authForm__title-btn-wrapper\">\n            <button className=\"authForm__title-btn\" onClick={() => setSwitched(false)} disabled={fetching}>\n              Войти\n            </button>\n          </div>\n          <div className=\"authForm__title-btn-wrapper\">\n            <button className=\"authForm__title-btn\" onClick={() => setSwitched(true)} disabled={fetching}>\n              Создать\n            </button>\n          </div>\n        </header>\n        {\n          switched\n          ? <Form className=\"form\" onSubmit={onSignUpFormSubmit}>\n              <div className=\"form__input-wrapper\">\n                <Field className=\"form__input\" type=\"email\" name=\"email\" required placeholder=\"Почта\" />\n              </div>\n              <div className=\"form__input-wrapper\"> \n                <Field className=\"form__input\" type=\"password\" name=\"password\" required placeholder=\"Пароль\" />\n              </div> \n              <div className=\"form__btn-wrapper\">\n                <button className=\"form__btn\" disabled={fetching}>Создать</button>\n              </div>\n              <p className=\"form__error\">{signUpError}</p>\n            </Form>\n          : <Form className=\"form\" onSubmit={onSignInFormSubmit}>\n              <div className=\"form__input-wrapper\">\n                <Field className=\"form__input\" type=\"email\" name=\"email\" required placeholder=\"Почта\" />\n              </div>\n              <div className=\"form__input-wrapper\">\n                <Field className=\"form__input\" type=\"password\" name=\"password\" required placeholder=\"Пароль\" />\n              </div>\n              <div className=\"form__btn-wrapper\">\n                <button className=\"form__btn\" disabled={fetching}>Войти</button>\n              </div>\n              <p className=\"form__error\">{signInError}</p>\n            </Form>\n        }\n      </div>\n    </div>\n  )\n}\n\nexport default AuthForm;","import { useContext, useRef, useState } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport { AuthContext } from \"../contexts\";\nimport { auth } from \"../firebase\";\nimport AuthForm from \"./Form/AuthForm\";\n\nconst body = document.body;\n\nconst Header = () => {\n  const { user } = useContext(AuthContext);\n  const [formOpen, setFormOpen] = useState();\n  const menu = useRef();\n\n  const closePopUpMenu = () => {\n    menu.current.classList.remove(\"header__item--active\");\n  }\n\n  const openForm = () => {\n    body.style.overflow = \"hidden\";\n    setFormOpen(true);\n  }\n\n  const closeForm = () => {\n    body.style.overflow = \"auto\";\n    setFormOpen(false);\n  }\n\n  return (\n    <>\n      <header className=\"header\">\n        <nav className=\"header__nav\">\n          <div className=\"header__menu-icon\" onClick={() => menu.current.classList.toggle(\"header__item--active\")}>\n            <div className=\"header__menu-line\"></div>\n          </div>\n          <div className=\"header__item\" ref={menu}>\n            <Link className=\"header__text header__link\" to={process.env.PUBLIC_URL + \"/\"} onClick={closePopUpMenu}>Главная</Link>\n            <Link className=\"header__text header__link\" to={process.env.PUBLIC_URL + \"/manage\"} onClick={closePopUpMenu}>Управление</Link>\n          </div>\n          <div className=\"header__item\">\n          {\n            user\n            ? <>\n              <span className=\"header__text header__auth\">{user.email}</span>\n              <span className=\"header__text header__auth\" onClick={() => auth.signOut()}>Выйти</span>\n              </>\n            : <span className=\"header__text header__auth\" onClick={openForm}>Войти</span>\n          }\n          </div>\n        </nav>\n      </header>\n      { formOpen && <AuthForm closeForm={closeForm} /> }\n    </>\n  )\n}\n\nexport default Header;","import { firestore } from \"../firebase\";\n\nconst collection = firestore.collection(\"books\");\n\nexport const bookAPI = {\n  remove: (id) => collection.doc(id).delete(),\n  addBook: (authors, name, year, isbn) => collection.add({ authors, name, year, isbn }).then(doc => doc.id),\n  editBook: (id, authors, name, year, isbn) => collection.doc(id).set({ authors, name, year, isbn })\n}","import React, { useCallback, useContext, useEffect, useReducer, useRef } from \"react\";\nimport { bookAPI } from \"../api/bookAPI\";\nimport { firestore } from \"./../firebase\";\n\nconst BookContext = React.createContext();\n\nconst collection = firestore.collection(\"books\");\n\nexport const useBookContext = () => useContext(BookContext);\n\nconst SET_BOOKS = \"SET_BOOKS\";\nconst TOGGLE_FETCHING = \"TOGGLE_FETCHING\";\nconst SET_NO_BOOKS_LEFT = \"SET_NO_BOOKS_LEFT\";\nconst REMOVE_BOOK = \"REMOVE_BOOK\";\nconst ADD_BOOK = \"ADD_BOOK\";\nconst EDIT_BOOK = \"EDIT_BOOK\"; \n\nconst initialState = {\n  books: [],\n  fetching: false,\n  noBooksLeft: false\n}\n\nconst reducer = (state, action) => {\n  switch (action.type) {\n    case SET_BOOKS:\n      return { ...state, books: [...state.books, ...action.books] }\n    case TOGGLE_FETCHING:\n      return { ...state, fetching: action.fetching }\n    case SET_NO_BOOKS_LEFT:\n      return { ...state, noBooksLeft: action.noBooksLeft }\n    case REMOVE_BOOK:\n      return { ...state, books: state.books.filter(b => b.id !== action.id) }\n    case ADD_BOOK:\n      return { ...state, books: [action.book, ...state.books] }\n    case EDIT_BOOK:\n      return { ...state, books: state.books.map(b => b.id === action.newBookData.id ? action.newBookData : b) }\n    default:\n      return state\n  } \n}\n\nconst BookProvider = ({ children }) => {\n  const [state, dispatch] = useReducer(reducer, initialState);\n  const lastDocRef = useRef();\n\n  const addBook = ({ name, authors, year, isbn }) => {\n    toggleFetchingDispatcher(true);\n    bookAPI.addBook(authors, name, year, isbn).then(id => {\n      addBookDispatcher({ id, name, authors, year, isbn })\n      toggleFetchingDispatcher(false);\n    });\n  }\n\n  const removeBook = (id) => {\n    toggleFetchingDispatcher(true);\n    bookAPI.remove(id).then(() => {\n      removeBookDispatcher(id);\n      toggleFetchingDispatcher(false);\n    });\n  }\n\n  const editBook = (id, { authors, name, year, isbn }) => {\n    toggleFetchingDispatcher(true);\n    bookAPI.editBook(id, authors, name, year, isbn).then(() => {\n      editBookDispatcher({ id, authors, name, year, isbn });\n      toggleFetchingDispatcher(false);\n    })\n  }\n\n  const toggleFetchingDispatcher = (isFetching) => dispatch({ type: TOGGLE_FETCHING, fetching: isFetching });\n\n  const setBooksDispatcher = (books) => dispatch({ type: SET_BOOKS, books });\n\n  const addBookDispatcher = (book) => dispatch({ type: ADD_BOOK, book });\n\n  const removeBookDispatcher = (id) => dispatch({ type: REMOVE_BOOK, id });\n\n  const editBookDispatcher = (newBookData) => dispatch({ type: EDIT_BOOK, newBookData });\n\n  const fetchBooks = useCallback((limit = 10) => {\n    toggleFetchingDispatcher(true);\n    collection\n      .orderBy(\"name\")\n      .startAfter(lastDocRef.current || 0)\n      .limit(limit)\n      .get()\n      .then(data => {\n        if (data.size === 0 && !state.noBooksLeft) {\n          dispatch({ type: SET_NO_BOOKS_LEFT, noBooksLeft: true });\n        } else {\n          const result = data.docs.map(doc => {\n            return { id: doc.id, ...doc.data()}\n          });\n          setBooksDispatcher(result);\n          \n          lastDocRef.current = data.docs[data.docs.length - 1];\n        }\n          toggleFetchingDispatcher(false);\n      });\n  }, [state.noBooksLeft]);\n\n  useEffect(() => {\n    fetchBooks(10);\n  }, [fetchBooks])\n\n  const value = {\n    state: state,\n    books: state.books,\n    fetchingBooks: state.fetching,\n    noBooksLeft: state.noBooksLeft,\n    removeBook, fetchBooks,\n    addBook, editBook\n  }\n\n  return (\n    <BookContext.Provider value={value}>\n      {children}\n    </BookContext.Provider>\n  )\n}\n\nexport default BookProvider;","import { useEffect, useRef } from \"react\"\n\nconst useFetchOnIntersection = (fetchFunc) => {\n  const observableNodeRef = useRef();\n  const observerRef = useRef();\n\n  useEffect(() => {\n    observerRef.current = new IntersectionObserver(([target]) => {\n      if (target.isIntersecting) fetchFunc();\n    }, {});\n\n    const observableNode = observableNodeRef.current;\n    observerRef.current.observe(observableNode);\n    \n    return () => observerRef.current.unobserve(observableNode);\n  }, [fetchFunc])\n\n  return { observableNodeRef, observerRef };\n}\n\nexport default useFetchOnIntersection;","const styles = {\n  padding: \".5em 1.25em\",\n  backgroundColor: \"rgba(106, 150, 185, .85)\",\n  border: \"1px solid rgb(121, 121, 121)\",\n  color: \"#fff\",\n  borderRadius: \"5px\",\n  cursor: \"pointer\",\n  outline: \"none\"\n}\n\nconst Button = ({ children, ...props }) => {\n  return <button {...props} style={styles}>{children}</button>\n}\n\nexport default Button;","import React, { useState } from \"react\";\nimport \"./../styles/Book.scss\";\nimport Button from \"./Form/Button\";\nimport Field from \"./Form/Field\";\nimport Form from \"./Form/Form\";\n\nconst AUTHOR_LIMIT = 3;\n\nconst Book = ({ name, authors, year, isbn, onClick, type, provideData }) => {\n  const [authorFieldCount, setAuthorFieldCount] = useState(type === \"edit\" ? authors.length : 1);\n  const [addMode, setAddMode] = useState(false);\n  const [editMode, setEditMode] = useState(false);\n\n  const authorFields = [];\n\n  for (let i = 1; i <= authorFieldCount; i++) {\n    authorFields.push(\n      <React.Fragment key={i}>\n        <Field className=\"book__input book__input-author\" name=\"authors\" type=\"text\" placeholder={`Автор ${i}`} value={authors && authors[i - 1]} required />\n        { \n          authorFieldCount === 1\n          ? <i className=\"book__fa-plus fas fa-plus\" onClick={() => setAuthorFieldCount(prev => prev + 1)}></i>\n          : authorFieldCount === AUTHOR_LIMIT && i === authorFieldCount\n          ? <i className=\"book__fa-minus fas fa-minus\" onClick={() => setAuthorFieldCount(prev => prev - 1)}></i>\n          : i === authorFieldCount &&\n          <>\n            <i className=\"book__fa-plus fas fa-plus\" onClick={() => setAuthorFieldCount(prev => prev + 1)}></i>\n            <i className=\"book__fa-minus fas fa-minus\" onClick={() => setAuthorFieldCount(prev => prev - 1)}></i>\n          </>\n        }\n      </React.Fragment>\n    )\n  }\n\n  if (type === \"add\") {\n    const onFormSubmit = (data) => {\n      provideData(data);\n      setAddMode(false);\n    }\n\n    return (\n      <div className=\"book\">\n      {\n        addMode\n        ?\n          <>\n            <div className=\"book__img\">Изображение</div>\n            <div className=\"book__desc\">\n              <Form className=\"book__form\" onSubmit={onFormSubmit}>\n                <div className=\"book__input-wrapper\">\n                  <Field className=\"book__input\" name=\"name\" type=\"text\" placeholder=\"Название\" required />\n                </div>\n                <div className=\"book__input-wrapper\">\n                  { authorFields }\n                </div>\n                <div className=\"book__input-wrapper\">\n                  <Field className=\"book__input\" name=\"year\" type=\"number\" placeholder=\"Год издания\" required />\n                </div>\n                <div className=\"book__input-wrapper\">\n                  <Field className=\"book__input\" name=\"isbn\" type=\"text\" placeholder=\"ISBN\" required />\n                </div>\n                <div className=\"book__btn\">\n                  <Button>Добавить</Button>\n                </div>\n              </Form>\n            </div>\n          </>\n        : <div className=\"book__add-book-plus-wrapper\" onClick={() => setAddMode(true)}>\n            <i className=\"book__add-book-plus fas fa-plus\"></i>\n          </div>\n      }\n      </div> \n    )\n  }\n\n  if (type === \"edit\") {\n    const onFormSubmit = (data) => {\n      provideData(data);\n      setEditMode(false);\n    }\n\n    return (\n      <div className=\"book\">\n        {\n          editMode\n          ? <>\n              <div className=\"book__img\">Изображение</div>\n                <div className=\"book__desc\">\n                  <Form className=\"book__form\" onSubmit={onFormSubmit}>\n                    <div className=\"book__input-wrapper\">\n                      <Field className=\"book__input\" name=\"name\" type=\"text\" placeholder=\"Название\" value={name} required />\n                    </div>\n                    <div className=\"book__input-wrapper\">\n                      { authorFields }\n                    </div>\n                    <div className=\"book__input-wrapper\">\n                      <Field className=\"book__input\" name=\"year\" type=\"number\" placeholder=\"Год издания\" value={year} required />\n                    </div>\n                    <div className=\"book__input-wrapper\">\n                      <Field className=\"book__input\" name=\"isbn\" type=\"text\" placeholder=\"ISBN\" value={isbn} required />\n                    </div>\n                    <div className=\"book__btn\">\n                      <Button>Сохранить</Button>\n                    </div>\n                  </Form>\n                </div>\n            </>\n          : <>\n              <div className=\"book__img\">Изображение</div>\n              <div className=\"book__desc\">\n                <p className=\"book__desc-item\"><b>Название: </b><span className=\"book__span\">{name}</span></p>\n                <p className=\"book__desc-item\">\n                  <b>Автор: </b>\n                  <span className=\"book__span\">{authors.join(\", \")}</span>\n                </p>\n                <p className=\"book__desc-item\"><b>Год издания: </b><span className=\"book__span\">{year}</span></p>\n                <p className=\"book__desc-item\"><b>ISBN: </b><span className=\"book__span\">{isbn}</span></p>\n              </div>\n              <div className=\"book__btn\">\n                <Button onClick={() => setEditMode(true)}>{\"Редактировать\"}</Button>\n              </div>\n            </>\n        }\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"book\">\n      <div className=\"book__img\">Изображение</div>\n      <div className=\"book__desc\">\n        <p className=\"book__desc-item\"><b>Название: </b><span className=\"book__span\">{name}</span></p>\n        <p className=\"book__desc-item\">\n          <b>Автор: </b>\n          <span className=\"book__span\">{authors.join(\", \")}</span>\n        </p>\n        <p className=\"book__desc-item\"><b>Год издания: </b><span className=\"book__span\">{year}</span></p>\n        <p className=\"book__desc-item\"><b>ISBN: </b><span className=\"book__span\">{isbn}</span></p>\n      </div>\n      <div className=\"book__btn\">\n        <Button onClick={onClick}>{\"Удалить\"}</Button>\n      </div>\n    </div>\n  )\n}\n\nexport default Book;","import { useCallback, useEffect } from \"react\";\nimport { useBookContext } from \"../contexts/BookContext\";\nimport useFetchOnIntersection from \"../utils/useFetchOnIntersection\";\nimport \"./../styles/MainPage.scss\";\nimport Book from './Book';\nimport { Link } from \"react-router-dom\";\n\nlet limit = 5;\n\nconst Books = () => {\n  const { books, removeBook, fetchBooks, fetchingBooks, noBooksLeft } = useBookContext();\n\n  const onScrollFetch = useCallback(() => {\n    fetchBooks(limit);\n  }, [fetchBooks]);\n\n  const { observableNodeRef, observerRef } = useFetchOnIntersection(onScrollFetch);\n\n  useEffect(() => {\n    if (noBooksLeft) {\n      observerRef.current.unobserve(observableNodeRef.current);\n    }\n  }, [noBooksLeft, observerRef, observableNodeRef])\n\n  return (\n    <div className=\"books\">\n      <div className=\"books__btn-wrapper\">\n        <Link className=\"books__btn\" to={process.env.PUBLIC_URL + \"/manage\"}>Добавить книгу</Link>\n      </div>\n      <br/>\n      <div className=\"books__library library\">\n        <ul className=\"library__list\">\n          {\n            books.map(book => \n              <li className=\"library__book\" key={book.id}>\n                <Book\n                  name={book.name}\n                  year={book.year}\n                  authors={book.authors}\n                  isbn={book.isbn}\n                  onClick={() => removeBook(book.id)}\n                  btnTitle=\"Удалить\"\n                />\n              </li>\n            )\n          }\n        </ul>\n      </div>\n      <div\n        ref={observableNodeRef}\n        className=\"books__fetch-point\" \n        style={{\n          height:\"25px\", \n          display: fetchingBooks ? \"none\" : \"block\"\n        }}\n        >\n      </div>\n      <div className=\"books__message\">\n        {noBooksLeft && !fetchingBooks && \"Больше книг нет\"}\n        {!noBooksLeft && fetchingBooks && \"Подгружаем книги...\"}\n      </div>\n    </div>\n  )\n}\n\nexport default Books;","import { useBookContext } from \"../contexts/BookContext\";\nimport Book from \"./Book\";\nimport \"./../styles/ManagePage.scss\";\nimport useFetchOnIntersection from \"../utils/useFetchOnIntersection\";\nimport { useCallback, useEffect } from \"react\";\n\nlet limit = 5;\n\nconst Manage = () => {\n  const { books, addBook, fetchBooks, fetchingBooks, noBooksLeft, editBook } = useBookContext();\n  \n  const onScrollFetch = useCallback(() => {\n    fetchBooks(limit);\n  }, [fetchBooks]);\n\n  const { observableNodeRef, observerRef } = useFetchOnIntersection(onScrollFetch);\n\n  const getFormInfo = (data) => {\n    let authors;\n    try {\n      authors = [...data.authors].map(a => a.value)\n    } catch {\n      authors = [data.authors.value]\n    }\n\n    return {\n      name: data.name.value,\n      authors: authors,\n      year: data.year.value,\n      isbn: data.isbn.value\n    }\n  }\n\n  const onAddBook = (data) => {\n    const dataCollection = getFormInfo(data);\n\n    addBook({ ...dataCollection });\n  }\n\n  const onEditBook = (id, data) => {\n    const dataCollection = getFormInfo(data);\n\n    editBook(id, { ...dataCollection })\n  }\n\n  useEffect(() => {\n    if (noBooksLeft) {\n      observerRef.current.unobserve(observableNodeRef.current);\n    }\n  }, [noBooksLeft, observerRef, observableNodeRef])\n\n  return (\n    <div className=\"manage\">\n      <h2 className=\"manage__title\">Управление книгами</h2>\n      <div className=\"manage__library library\">\n        <ul className=\"library__list\">\n          <li className=\"library__book\">\n            <Book provideData={onAddBook} type=\"add\" />\n          </li>\n          {\n            books.map(book => \n              <li className=\"library__book\" key={book.id}>\n                <Book\n                  name={book.name}\n                  authors={book.authors}\n                  year={book.year}\n                  isbn={book.isbn}\n                  type=\"edit\"\n                  provideData={(data) => onEditBook(book.id, data)}\n                />\n              </li>\n            )\n          }\n        </ul>\n      </div>\n      <div\n        ref={observableNodeRef}\n        className=\"books__fetch-point\" \n        style={{\n          height:\"25px\", \n          display: fetchingBooks ? \"none\" : \"block\"\n        }}\n        >\n      </div>\n      <div className=\"books__message\">\n        {noBooksLeft && !fetchingBooks && \"Больше книг нет\"}\n        {!noBooksLeft && fetchingBooks && \"Подгружаем книги...\"}\n      </div>\n    </div>\n  )\n}\n\nexport default Manage;","import './styles/App.scss';\nimport { BrowserRouter as Router, Route, Switch } from \"react-router-dom\";\nimport Header from \"./components/Header\";\nimport { auth } from \"./firebase\";\nimport { useEffect, useState } from 'react';\nimport { AuthContext } from \"./contexts\";\nimport Books from './components/Books';\nimport BookProvider from './contexts/BookContext';\nimport Manage from './components/Manage';\n\nconst App = () => {\n  const [user, setUser] = useState();\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    auth.onAuthStateChanged(user => {\n      setLoading(false);\n      setUser(user);\n    })\n  }, []);\n\n  const value = {\n    user\n  }\n\n  return (\n    <Router basename={process.env.PUBLIC_URL}>\n      {\n        !loading &&\n        <AuthContext.Provider value={value}>         \n          <Header />\n          <div id=\"page\">\n            <Switch>\n              \n              <BookProvider>\n                <Route exact path=\"/\" component={Books} />\n                <Route path=\"/manage\" component={Manage} />\n              </BookProvider>\n            </Switch>\n          </div>\n        </AuthContext.Provider>\n      }\n    </Router>\n  )\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.scss';\nimport App from './App';\nimport \"normalize.css\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);"],"sourceRoot":""}